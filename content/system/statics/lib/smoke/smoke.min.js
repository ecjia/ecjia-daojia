var smoke={smoketimeout:[],init:false,zindex:1000,i:0,bodyload:function(b){var a=document.createElement("div");a.setAttribute("id","smoke-out-"+b);a.className="smoke-base";a.style.zIndex=smoke.zindex;smoke.zindex++;document.body.appendChild(a)},newdialog:function(){var a=new Date().getTime();a=Math.random(1,99)+a;if(!smoke.init){smoke.listen(window,"load",function(){smoke.bodyload(a)})}else{smoke.bodyload(a)}return a},forceload:function(){},build:function(j,h){smoke.i++;h.stack=smoke.i;j=j.replace(/\n/g,"<br />");j=j.replace(/\r/g,"<br />");j='<div class="dialog-info">'+j+"</div>";var a="",b="OK",g="Cancel",i="",d="",c;if(h.type==="prompt"){a='<div class="dialog-prompt"><input id="dialog-input-'+h.newid+'" type="text" '+(h.params.value?'value="'+h.params.value+'"':"")+" /></div>"}if(h.params.ok){b=h.params.ok}if(h.params.cancel){g=h.params.cancel}if(h.params.classname){i=h.params.classname}if(h.type!=="signal"){d='<div class="dialog-buttons">';if(h.type==="alert"){d+='<button class="btn" id="alert-ok-'+h.newid+'">'+b+"</button>"}else{if(h.type==="prompt"||h.type==="confirm"){if(h.params.reverseButtons){d+='<button class="btn" id="'+h.type+"-ok-"+h.newid+'">'+b+'</button><button class="btn" id="'+h.type+"-cancel-"+h.newid+'" class="cancel">'+g+"</button>"}else{d+='<button class="btn" id="'+h.type+"-cancel-"+h.newid+'" class="cancel">'+g+'</button><button class="btn" id="'+h.type+"-ok-"+h.newid+'">'+b+"</button>"}}}d+="</div>"}c='<div id="smoke-bg-'+h.newid+'" class="smokebg"></div><div class="dialog smoke '+i+'"><div class="dialog-inner">'+j+a+d+"</div></div>";if(!smoke.init){smoke.listen(window,"load",function(){smoke.finishbuild(j,h,c)})}else{smoke.finishbuild(j,h,c)}},finishbuild:function(d,c,b){var a=document.getElementById("smoke-out-"+c.newid);a.className="smoke-base smoke-visible  smoke-"+c.type;a.innerHTML=b;while(a.innerHTML===""){a.innerHTML=b}if(smoke.smoketimeout[c.newid]){clearTimeout(smoke.smoketimeout[c.newid])}smoke.listen(document.getElementById("smoke-bg-"+c.newid),"click",function(){smoke.destroy(c.type,c.newid);if(c.type==="prompt"||c.type==="confirm"){c.callback(false)}else{if(c.type==="alert"&&typeof c.callback!=="undefined"){c.callback()}}});switch(c.type){case"alert":smoke.finishbuildAlert(d,c,b);break;case"confirm":smoke.finishbuildConfirm(d,c,b);break;case"prompt":smoke.finishbuildPrompt(d,c,b);break;case"signal":smoke.finishbuildSignal(d,c,b);break;default:throw"Unknown type: "+c.type}},finishbuildAlert:function(c,b,a){smoke.listen(document.getElementById("alert-ok-"+b.newid),"click",function(){smoke.destroy(b.type,b.newid);if(typeof b.callback!=="undefined"){b.callback()}});document.onkeyup=function(d){if(!d){d=window.event}if(d.keyCode===13||d.keyCode===32||d.keyCode===27){smoke.destroy(b.type,b.newid);if(typeof b.callback!=="undefined"){b.callback()}}}},finishbuildConfirm:function(c,b,a){smoke.listen(document.getElementById("confirm-cancel-"+b.newid),"click",function(){smoke.destroy(b.type,b.newid);b.callback(false)});smoke.listen(document.getElementById("confirm-ok-"+b.newid),"click",function(){smoke.destroy(b.type,b.newid);b.callback(true)});document.onkeyup=function(d){if(!d){d=window.event}if(d.keyCode===13||d.keyCode===32){smoke.destroy(b.type,b.newid);b.callback(true)}else{if(d.keyCode===27){smoke.destroy(b.type,b.newid);b.callback(false)}}}},finishbuildPrompt:function(d,b,a){var c=document.getElementById("dialog-input-"+b.newid);setTimeout(function(){c.focus();c.select()},100);smoke.listen(document.getElementById("prompt-cancel-"+b.newid),"click",function(){smoke.destroy(b.type,b.newid);b.callback(false)});smoke.listen(document.getElementById("prompt-ok-"+b.newid),"click",function(){smoke.destroy(b.type,b.newid);b.callback(c.value)});document.onkeyup=function(f){if(!f){f=window.event}if(f.keyCode===13){smoke.destroy(b.type,b.newid);b.callback(c.value)}else{if(f.keyCode===27){smoke.destroy(b.type,b.newid);b.callback(false)}}}},finishbuildSignal:function(c,b,a){smoke.smoketimeout[b.newid]=setTimeout(function(){smoke.destroy(b.type,b.newid)},b.timeout)},destroy:function(a,e){var b=document.getElementById("smoke-out-"+e),d=document.getElementById(a+"-ok-"+e),c=document.getElementById(a+"-cancel-"+e);b.className="smoke-base";if(d){smoke.stoplistening(d,"click",function(){});document.onkeyup=null}if(c){smoke.stoplistening(c,"click",function(){})}smoke.i=0;b.innerHTML="";if(b.parentNode){b.parentNode.removeChild(b)}},alert:function(c,b,a){if(typeof b!=="object"){b=false}var d=smoke.newdialog();smoke.build(c,{type:"alert",callback:a,params:b,newid:d})},signal:function(b,a){if(typeof a==="undefined"){a=5000}var c=smoke.newdialog();smoke.build(b,{type:"signal",timeout:a,params:false,newid:c})},confirm:function(c,b,a){if(typeof a!=="object"){a=false}var d=smoke.newdialog();smoke.build(c,{type:"confirm",callback:b,params:a,newid:d})},prompt:function(c,b,a){if(typeof a!=="object"){a=false}var d=smoke.newdialog();return smoke.build(c,{type:"prompt",callback:b,params:a,newid:d})},listen:function(c,b,a){if(c.addEventListener){return c.addEventListener(b,a,false)}if(c.attachEvent){return c.attachEvent("on"+b,a)}return false},stoplistening:function(c,b,a){if(c.removeEventListener){return c.removeEventListener("click",a,false)}if(c.detachEvent){return c.detachEvent("on"+b,a)}return false}};if(!smoke.init){smoke.listen(window,"load",function(){smoke.init=true})};