(function(b){function f(a,e){this.el=b(a);this.options=e||{};this.x=!1!==this.options.x;this.y=!1!==this.options.y;this.padding=void 0==this.options.padding?2:this.options.padding;this.inner=this.el.find(".antiscroll-inner");this.inner.css({width:"+="+h(),height:"+="+h()});this.refresh()}function c(a){this.pane=a;this.pane.el.append(this.el);this.innerEl=this.pane.inner.get(0);this.shown=this.enter=this.dragging=!1;this.pane.el.mouseenter(b.proxy(this,"mouseenter"));this.pane.el.mouseleave(b.proxy(this,
"mouseleave"));this.el.mousedown(b.proxy(this,"mousedown"));this.pane.inner.scroll(b.proxy(this,"scroll"));this.pane.inner.bind("mousewheel",b.proxy(this,"mousewheel"));a=this.pane.options.initialDisplay;!1!==a&&(this.show(),this.hiding=setTimeout(b.proxy(this,"hide"),parseInt(a,10)||3E3))}function j(a,e){function d(){}d.prototype=e.prototype;a.prototype=new d}function h(){if(void 0===g){var a=b('<div class="antiscroll-inner" style="width:50px;height:50px;overflow-y:scroll;position:absolute;top:-200px;left:-200px;"><div style="height:100px;width:100%"></div>');
b("body").append(a);var e=b(a).innerWidth(),d=b("div",a).innerWidth();b(a).remove();g=e-d}return g}b.fn.antiscroll=function(a){return this.each(function(){b(this).data("antiscroll")&&b(this).data("antiscroll").destroy();b(this).data("antiscroll",new b.Antiscroll(this,a))})};b.Antiscroll=f;f.prototype.refresh=function(){var a=this.inner.get(0).scrollWidth>this.el.width(),e=this.inner.get(0).scrollHeight>this.el.height();!this.horizontal&&a&&this.x?this.horizontal=new c.Horizontal(this):this.horizontal&&
!a&&(this.horizontal.destroy(),this.horizontal=null);!this.vertical&&e&&this.y?this.vertical=new c.Vertical(this):this.vertical&&!e&&(this.vertical.destroy(),this.vertical=null)};f.prototype.destroy=function(){this.horizontal&&this.horizontal.destroy();this.vertical&&this.vertical.destroy();return this};f.prototype.rebuild=function(){this.destroy();this.inner.attr("style","");f.call(this,this.el,this.options);return this};c.prototype.destroy=function(){this.el.remove();return this};c.prototype.mouseenter=
function(){this.enter=!0;this.show()};c.prototype.mouseleave=function(){this.enter=!1;this.dragging||this.hide()};c.prototype.scroll=function(){this.shown||(this.show(),!this.enter&&!this.dragging&&(this.hiding=setTimeout(b.proxy(this,"hide"),1500)));this.update()};c.prototype.mousedown=function(a){a.preventDefault();this.dragging=!0;this.startPageY=a.pageY-parseInt(this.el.css("top"),10);this.startPageX=a.pageX-parseInt(this.el.css("left"),10);document.onselectstart=function(){return!1};var e=b.proxy(this,
"mousemove"),d=this;b(document).mousemove(e).mouseup(function(){d.dragging=!1;document.onselectstart=null;b(document).unbind("mousemove",e);d.enter||d.hide()})};c.prototype.show=function(){this.shown||(this.update(),this.el.addClass("antiscroll-scrollbar-shown"),this.hiding&&(clearTimeout(this.hiding),this.hiding=null),this.shown=!0)};c.prototype.hide=function(){!1!==this.pane.options.autoHide&&this.shown&&(this.el.removeClass("antiscroll-scrollbar-shown"),this.shown=!1)};c.Horizontal=function(a){this.el=
b('<div class="antiscroll-scrollbar antiscroll-scrollbar-horizontal">');c.call(this,a)};j(c.Horizontal,c);c.Horizontal.prototype.update=function(){var a=this.pane.el.width(),e=a-2*this.pane.padding,d=this.pane.inner.get(0);this.el.css("width",e*a/d.scrollWidth).css("left",e*d.scrollLeft/d.scrollWidth)};c.Horizontal.prototype.mousemove=function(a){var e=this.pane.el.width()-2*this.pane.padding,d=a.pageX-this.startPageX;a=this.el.width();var b=this.pane.inner.get(0),d=Math.min(Math.max(d,0),e-a);b.scrollLeft=
(b.scrollWidth-this.pane.el.width())*d/(e-a)};c.Horizontal.prototype.mousewheel=function(a,b,d){if(0>d&&0==this.pane.inner.get(0).scrollLeft||0<d&&this.innerEl.scrollLeft+Math.ceil(this.pane.el.width())==this.innerEl.scrollWidth)return a.preventDefault(),!1};c.Vertical=function(a){this.el=b('<div class="antiscroll-scrollbar antiscroll-scrollbar-vertical">');c.call(this,a)};j(c.Vertical,c);c.Vertical.prototype.update=function(){var a=this.pane.el.height(),b=a-2*this.pane.padding,d=this.innerEl;this.el.css("height",
b*a/d.scrollHeight).css("top",b*d.scrollTop/d.scrollHeight)};c.Vertical.prototype.mousemove=function(a){var b=this.pane.el.height(),d=b-2*this.pane.padding,c=a.pageY-this.startPageY;a=this.el.height();var f=this.innerEl,c=Math.min(Math.max(c,0),d-a);f.scrollTop=(f.scrollHeight-b)*c/(d-a)};c.Vertical.prototype.mousewheel=function(a,b,c,f){if(0<f&&0==this.innerEl.scrollTop||0>f&&this.innerEl.scrollTop+Math.ceil(this.pane.el.height())==this.innerEl.scrollHeight)return a.preventDefault(),!1};var g})(jQuery);